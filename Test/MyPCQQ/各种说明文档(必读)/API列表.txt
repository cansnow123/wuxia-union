
Api说明文档
若未特别声明 以下所有Api均封装于message.dll内

Api_GetGtk_Bkn 返回类型:文本型 说明:根据提交的QQ号计算得到页面操作用参数Bkn或G_tk
.参数 响应的QQ, 文本型


Api_GetBkn32 返回类型:文本型 说明:根据提交的QQ号计算得到页面操作用参数长Bkn或长G_tk
.参数 响应的QQ, 文本型


Api_GetLdw 返回类型:文本型 说明:根据提交的QQ号计算得到页面操作用参数长Ldw
.参数 响应的QQ, 文本型


Api_GetRunPath 返回类型:文本型 说明:取得框架所在目录.可能鸡肋了。


Api_GetOnlineQQlist 返回类型:文本型 说明:取得当前框架内在线可用的QQ列表


Api_GetQQlist 返回类型:文本型 说明:取得框架内所有QQ列表。包括未登录以及登录失败的QQ


Api_GetSessionkey 返回类型:文本型 说明:根据QQ取得对应的会话秘钥
.参数 响应的QQ, 文本型


Api_GetClientkey 返回类型:文本型 说明:取得页面登录用的Clientkey
.参数 响应的QQ, 文本型


Api_GetLongClientkey 返回类型:文本型 说明:取得页面登录用的长Clientkey
.参数 响应的QQ, 文本型


Api_GetCookies 返回类型:文本型 说明:取得页面操作用的Cookies
.参数 响应的QQ, 文本型


Api_GetPrefix 返回类型:文本型 说明:取得框架内设置的信息发送前缀


Api_Cache_NameCard 返回类型:无 说明:将群名片加入高速缓存当作.
.参数 群号, 文本型
.参数 QQ, 文本型
.参数 名片, 文本型


Api_DBan 返回类型:无 说明:将指定QQ移出QQ黑名单
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_Ban 返回类型:无 说明:将指定QQ列入QQ黑名单
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_Shutup 返回类型:逻辑型 说明:禁言群成员
.参数 响应的QQ, 文本型
.参数 群号, 文本型, , 禁言对象所在群.
.参数 QQ, 文本型, , 禁言对象.留空为全群禁言
.参数 时长, 整数型, , 单位:秒 最大为1个月. 为零解除对象或全群禁言


Api_IsShutup 返回类型:逻辑型 说明:根据群号+QQ判断指定群员是否被禁言  获取失败的情况下亦会返回假
.参数 响应的QQ, 文本型
.参数 群号, 文本型, , 欲判断对象所在群.
.参数 QQ, 文本型, , 欲判断对象


Api_SetNotice 返回类型:无 说明:发群公告
.参数 响应的QQ, 文本型
.参数 群号, 文本型
.参数 标题, 文本型
.参数 内容, 文本型


Api_GetNotice 返回类型:文本型 说明:取群公告
.参数 响应的QQ, 文本型
.参数 群号, 文本型


Api_GetNameCard 返回类型:文本型 说明:取群名片
.参数 响应的QQ, 文本型
.参数 群号, 文本型
.参数 QQ, 文本型


Api_SetNameCard 返回类型:无 说明:设置群名片
.参数 响应的QQ, 文本型
.参数 群号, 文本型
.参数 QQ, 文本型
.参数 名片, 文本型


Api_QuitDG 返回类型:无 说明:退出讨论组
.参数 响应的QQ, 文本型
.参数 讨论组ID, 文本型


Api_DelFriend 返回类型:逻辑型 说明:删除好友
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_Kick 返回类型:逻辑型 说明:将对象移除群
.参数 响应的QQ, 文本型
.参数 群号, 文本型
.参数 对象, 文本型


Api_JoinGroup 返回类型:无 说明:主动加群.为了避免广告、群发行为。出现验证码时将会直接失败不处理
.参数 响应的QQ, 文本型
.参数 群号, 文本型
.参数 附加理由, 文本型


Api_QuitGroup 返回类型:无 说明:退出群
.参数 响应的QQ, 文本型
.参数 群号, 文本型

Api_UploadPic 返回类型:文本型 说明:返回值:成功返回图片GUID用于发送该图片.失败返回空.  图片尺寸应小于4MB
.参数 响应的QQ, 文本型, , 机器人QQ
.参数 参_上传类型, 整数型, , 1好友2群 注:好友图和群图的GUID并不相同并不通用 需要非别上传。群、讨论组用类型2 临时会话、好友信息需要类型1
.参数 参_参考对象, 文本型, , 上传该图片所属的群号或QQ
.参数 参_图片数据, 字节集, 参考, 图片字节集数据或字节集数据指针() 


Api_GuidGetPicLink 返回类型:文本型 说明:根据图片GUID取得图片下载连接 失败返回空
.参数 图片GUID, 文本型, , {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}.jpg这样的GUID


Api_SendMsg 返回类型:整数型 说明:向对象、目标发送信息 支持好友 群 讨论组 群临时会话 讨论组临时会话
.参数 响应的QQ, 文本型
.参数 信息类型, 整数型, , 1好友 2群 3讨论组 4群临时会话 5讨论组临时会话
.参数 参考子类型, 整数型, , 无特殊说明情况下留空或填零
.参数 收信群_讨论组, 文本型, , 发送群信息、讨论组信息、群临时会话信息、讨论组临时会话信息时填写
.参数 收信对象, 文本型, , 最终接收这条信息的对象QQ
.参数 内容, 文本型, , 信息内容


Api_Send 返回类型:文本型 说明:向服务器直接发送一个加密封装完成后的封包。成功返回服务器回传加密后的响应包体。失败或超时返回空
.参数 封包内容, 文本型


Api_OutPut 返回类型:整数型 说明:在框架记录页输出一行信息
.参数 内容, 文本型, , 输出的内容


Api_IsEnable 返回类型:逻辑型 说明:取得本插件启用状态


Api_Login 返回类型:逻辑型 说明:登录一个现存的QQ
.参数 QQ, 文本型, , 欲登录的Q


Api_Logout 返回类型:无 说明:让指定QQ下线
.参数 QQ, 文本型


Api_Tea加密 返回类型:文本型 说明:tean加密算法
.参数 加密内容, 文本型
.参数 Key, 文本型


Api_Tea解密 返回类型:文本型 说明:tean解密算法
.参数 解密内容, 文本型
.参数 Key, 文本型


Api_GetNick 返回类型:文本型 说明:取用户名
.参数 QQ, 文本型


Api_GetQQLevel 返回类型:文本型 说明:取QQ等级+QQ会员等级 返回json格式信息
.参数 QQ, 文本型


Api_GNGetGid 返回类型:文本型 说明:群号转群ID
.参数 群号, 文本型


Api_GidGetGN 返回类型:文本型 说明:群ID转群号
.参数 群ID, 文本型


Api_GetVersion 返回类型:整数型 说明:取框架版本号(发布时间戳


Api_GetVersionName 返回类型:文本型 说明:取框架版本名


Api_GetTimeStamp 返回类型:整数型 说明:取当前框架内部时间戳_周期性与服务器时间同步


Api_GetLog 返回类型:文本型 说明:取得框架输出列表内所有信息


Api_IfBlock 返回类型:逻辑型 说明:判断是否处于被屏蔽群信息状态。
.参数 响应的QQ, 文本型


Api_GetAdminList 返回类型:文本型 说明:取包括群主在内的群管列表
.参数 响应的QQ, 文本型
.参数 群号, 文本型


Api_AddTaotao 返回类型:文本型 说明:发说说
.参数 响应的QQ, 文本型
.参数 内容, 文本型


Api_GetSign 返回类型:文本型 说明:取个签
.参数 响应的QQ, 文本型
.参数 对象, 文本型


Api_SetSign 返回类型:文本型 说明:设置个签
.参数 响应的QQ, 文本型
.参数 内容, 文本型


Api_GetGroupListA 返回类型:文本型 说明:通过qun.qzone.qq.com接口取得取群列表.成功返回转码后的JSON格式文本信息
.参数 响应的QQ, 文本型


Api_GetGroupListB 返回类型:文本型 说明:通过qun.qq.com接口取得取群列表.成功返回转码后的JSON格式文本信息
.参数 响应的QQ, 文本型


Api_GetGroupMemberA 返回类型:文本型 说明:通过qun.qq.com接口取得群成员列表 成功返回转码后的JSON格式文本
.参数 响应的QQ, 文本型
.参数 群号, 文本型


Api_GetGroupMemberB 返回类型:文本型 说明:通过qun.qzone.qq.com接口取得群成员列表 成功返回转码后的JSON格式文本
.参数 响应的QQ, 文本型
.参数 群号, 文本型


Api_GetFriendList 返回类型:文本型 说明:通过qun.qq.com接口取得好友列表。成功返回转码后的JSON文本
.参数 响应的QQ, 文本型


Api_GetQQAge 返回类型:整数型 说明:取Q龄 成功返回Q龄 失败返回-1
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_GetAge 返回类型:整数型 说明:取年龄 成功返回年龄 失败返回-1
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_GetPersonalProfile 返回类型:文本型 说明:取个人说明
.参数 响应的QQ, 文本型
.参数 QQ, 文本型, , 对象QQ


Api_GetEmail 返回类型:文本型 说明:取邮箱 成功返回邮箱 失败返回空
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_GetGender 返回类型:整数型 说明:取对象性别 1男 2女  未或失败返回-1
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_SendTyping 返回类型:整数型 说明:向好友发送‘正在输入’的状态信息.当好友收到信息之后 “正在输入”状态会立刻被打断
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_SendShake 返回类型:整数型 说明:向好友发送窗口抖动信息
.参数 响应的QQ, 文本型
.参数 QQ, 文本型


Api_GetRadomOnlineQQ 返回类型:文本型 说明:取得框架内随机一个在线且可以使用的QQ


Api_AddQQ 返回类型:逻辑型 说明:往帐号列表添加一个Q.当该Q已存在时则覆盖密码
.参数 QQ, 文本型
.参数 密码, 文本型
.参数 自动登录, 逻辑型, , 运行框架时是否自动登录该Q.若添加后需要登录该Q则需要通过Api_Login操作


Api_SetOLStatus 返回类型:逻辑型 说明:设置在线状态+附加信息 
.参数 响应的QQ, 文本型
.参数 在线状态, 整数型, , 1~6 分别对应我在线上, Q我吧, 离开, 忙碌, 请勿打扰, 隐身
.参数 状态附加信息, 文本型, , 最大255字节


Api_GetMC 返回类型:文本型 说明:取得机器码


Api_GroupInvitation 返回类型:文本型 说明:邀请对象加入群 失败返回错误理由
.参数 响应的QQ, 文本型
.参数 好友QQ, 文本型, , 多个好友用换行分割
.参数 群号, 文本型


Api_CreateDG 返回类型:文本型 说明:创建一个讨论组 成功返回讨论组ID 失败返回空 注:每24小时只能创建100个讨论组 悠着点用
.参数 响应的QQ, 文本型


Api_KickDG 返回类型:文本型 说明:将对象移除讨论组.成功返回空 失败返回理由
.参数 响应的QQ, 文本型
.参数 讨论组ID, 文本型
.参数 成员, 文本型


Api_DGInvitation 返回类型:文本型 说明:邀请对象加入讨论组 成功返回空 失败返回理由
.参数 响应的QQ, 文本型
.参数 讨论组ID, 文本型
.参数 成员组, 文本型, , 多个成员用换行符分割


Api_GetDGList 返回类型:文本型 说明:成功返回以换行符分割的讨论组号列表.最大为100个讨论组  失败返回空
.参数 响应的QQ, 文本型


Api_SendMusic 返回类型:逻辑型 说明:向对象发送一条音乐信息（所谓的点歌）次数不限
.参数 响应的QQ, 文本型
.参数 收信对象类型, 整数型, , 同Api_SendMsg  1好友 2群 3讨论组 4群临时会话 5讨论组临时会话
.参数 收信对象所属群_讨论组, 文本型, , 发群内、临时会话必填 好友可不填
.参数 收信对象QQ, 文本型, , 临时会话、好友必填 发至群内可不填
.参数 音乐简介, 文本型, , 留空默认‘QQ音乐 的分享’
.参数 音乐播放页面连接, 文本型, , 任意直连或短链接均可 留空为空 无法点开
.参数 音乐封面连接, 文本型, , 任意直连或短链接均可 可空 例:http://url.cn/cDiJT4
.参数 音乐文件直连连接, 文本型, , 任意直连或短链接均可 不可空 例:http://url.cn/djwXjr
.参数 曲名, 文本型, , 可空
.参数 歌手名, 文本型, , 可空
.参数 音乐来源名, 文本型, , 可空 为空默认QQ音乐
.参数 音乐来源图标连接, 文本型, , 可空 为空默认QQ音乐 http://qzonestyle.gtimg.cn/ac/qzone/applogo/64/308/100497308_64.gif


Api_SendObjectMsg 返回类型:逻辑型 说明:
.参数 响应的QQ, 文本型
.参数 收信对象类型, 整数型, , 同Api_SendMsg  1好友 2群 3讨论组 4群临时会话 5讨论组临时会话
.参数 收信对象所属群_讨论组, 文本型, , 发群内、临时会话必填 好友可不填
.参数 收信对象QQ, 文本型, , 临时会话、好友必填 发至群内可不填
.参数 ObjectMsg, 文本型
.参数 结构子类型, 整数型, , 00 基本 02 点歌 其他不明


Api_IsFriend 返回类型:逻辑型 说明:判断对象是否为好友（双向）
.参数 响应的QQ, 文本型
.参数 对象QQ, 文本型


Api_AddFriend 返回类型:逻辑型 说明:主动加好友 成功返回真 失败返回假 当对象设置需要正确回答问题或不允许任何人添加时无条件失败
.参数 响应的QQ, 文本型, , 机器人QQ
.参数 对象QQ, 文本型, , 加谁
.参数 附加理由, 文本型, , 加好友提交的理由

Api_SelfDisable 返回类型:无 说明:无参 用于插件自身请求禁用插件自身

Api_GetClientType 返回类型:整数型 说明:取协议客户端类型常量 失败返回0

Api_GetClientVer 返回类型:整数型 说明:取协议客户端版本号常量  失败返回0

Api_GetPubNo 返回类型:整数型 说明:取协议客户端公开版本号常量  失败返回0

Api_GetMainVer 返回类型:整数型 说明:取协议客户端主版本号常量  失败返回0

Api_GetTXSSOVer 返回类型:整数型 说明:取协议客户端通信模块(TXSSO)版本号常量  失败返回0

Api_UploadVoice 返回类型:文本型 说明:上传音频文件 成功返回guid用于发送
.参数 响应的QQ, 文本型
.参数 amr音频数据, 整数型, , 音频字节集数据

Api_GuidGetVoiceLink 返回类型:文本型 说明:通过音频、语音guid取得下载连接
.参数 响应的QQ, 文本型
.参数 GUID, 文本型, , 格式:{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxx}.amr

Api_AddLogHandler 返回类型:逻辑型说明: 添加一个日志处理函数。每条新日志信息输出都会投递给该函数处理、重复添加将覆盖旧的、之前的接口
.参数 参_处理函数指针, 子程序指针, , 回调子程序、函数指针(内存地址)。函数仅一个参数。参数1为 结构体LOGSTRUCT指针

Api_RemoveLogHandler 返回类型:无返回 说明:移除由Api_AddLogHandler添加、设置的日志处理函数





处理函数原型:
C风格:
struct LOGSTRUCT{
unsigned long dwLogType;/*四字节无符号日志信息类型*/
char *LogText;/*Ansi编码日志信息指针*/
char *Response;/*Ansi编码响应对象信息指针*/
}
int LogHandler(LOGSTRUCT *Msg);//返回非0阻塞/屏蔽/拦截本条日志信息

易语言:
.数据类型 结构_LOGSTRUCT
    .成员 日志类型, 整数型, , , 四字节无符号日志信息类型
    .成员 日志内容, 文本型, , , 日志文本信息内容
.成员 响应对象, 文本型, , , 响应对象信息

.子程序 处理函数, , , 
.参数 参_处理函数指针, 结构_LOGSTRUCT, , 


注:由于易DLL并不支持结构体传递 因而实际编写时需将参数“参_处理函数指针”类型改为“整数型” 否则无法取地址或编译
实际使用请参考以下代码
.版本 2

.子程序 处理函数, 整数型, 公开
.参数 参_结构指针, 整数型
.局部变量 局_缓冲变量, 结构_LOGSTRUCT
.局部变量 局_LOGSTRUCT, 结构_LOGSTRUCT

强制交换变量 (局_缓冲变量, 参_结构指针)  ' 交换数据指针
局_LOGSTRUCT ＝ 局_缓冲变量  ' 拷贝数据
强制交换变量 (局_缓冲变量, 参_结构指针)  ' 交换数据指针 还原原变量
' 局_LOGSTRUCT便是所需结构体数据
返回(1)'返回非0阻塞/屏蔽/拦截本条日志信息
日志类型:
' 0未定义
' 1好友
' 2群
' 3讨论组
' 4群临时
' 5讨论组临时
' 1000登录
' 2000插件输出
' 10000提示
' 10001发送
' 10002事件
' 10003框架自检
' 20000错误-不严重的 可忽略的
' 20001错误-严重的 不可忽略的
' 20002错误-致命的 引起崩溃的